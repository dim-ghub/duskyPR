[config]
# ...

[templates.master_dump]
input_path = "~/.config/matugen/templates/master-dump.jsonl"
output_path = "~/.config/matugen/generated/master-dump.jsonl"

# -----------------------------------------------------------------------------
# GTK & Qt
# -----------------------------------------------------------------------------

[templates.gtk3]
input_path  = '~/.config/matugen/templates/gtk-colors.css'
output_path = '~/.config/matugen/generated/gtk-3.css'

[templates.gtk4]
input_path  = '~/.config/matugen/templates/gtk-colors.css'
output_path = '~/.config/matugen/generated/gtk-4.css'
post_hook   = '''
bash -c '
{
  mkdir -p "$HOME/.config/gtk-3.0" "$HOME/.config/gtk-4.0"
  ln -nfs "$HOME/.config/matugen/generated/gtk-3.css" "$HOME/.config/gtk-3.0/gtk.css"
  ln -nfs "$HOME/.config/matugen/generated/gtk-4.css" "$HOME/.config/gtk-4.0/gtk.css"
  gsettings set org.gnome.desktop.interface gtk-theme "adw-gtk3"
} >/dev/null 2>&1 </dev/null & disown
'
'''

[templates.qt5ct]
input_path  = '~/.config/matugen/templates/qtct-colors.conf'
output_path = '~/.config/matugen/generated/qt5ct-colors.conf'

[templates.qt6ct]
input_path  = '~/.config/matugen/templates/qtct-colors.conf'
output_path = '~/.config/matugen/generated/qt6ct-colors.conf'

[templates.papirus]
input_path  = '~/.config/matugen/templates/papirus'
output_path = '~/.config/matugen/generated/papirus'
post_hook   = '''
bash -c '
{
  COLOR_FILE="$HOME/.config/matugen/generated/papirus"
  [[ -f "$COLOR_FILE" ]] || exit 0
  read -r TARGET < "$COLOR_FILE"
  TARGET=${TARGET//#}
  TARGET=${TARGET// }
  [[ ${#TARGET} -ge 6 ]] || exit 0
  TARGET=${TARGET:0:6}
  closest=$(python3 -c "
  import sys
  colors = {\"adwaita\": \"93c0ea\", \"black\": \"4f4f4f\", \"blue\": \"5294e2\", \"bluegrey\": \"607d8b\", \"breeze\": \"57b8ec\", \"brown\": \"ae8e6c\", \"carmine\": \"a30002\", \"cyan\": \"00bcd4\", \"darkcyan\": \"45abb7\", \"deeporange\": \"eb6637\", \"green\": \"87b158\", \"grey\": \"8e8e8f\", \"indigo\": \"5c6bc0\", \"magenta\": \"ca71df\", \"nordic\": \"81a1c1\", \"orange\": \"ee923a\", \"palebrown\": \"d1bfae\", \"paleorange\": \"eeca8f\", \"pink\": \"f06292\", \"red\": \"e25252\", \"teal\": \"16a085\", \"violet\": \"7e57c2\", \"white\": \"e4e4e4\", \"yaru\": \"676767\", \"yellow\": \"f9bd30\"}
  target = \"$TARGET\"
  tr, tg, tb = int(target[0:2], 16), int(target[2:4], 16), int(target[4:6], 16)
  print(min(colors.keys(), key=lambda name: (int(colors[name][0:2], 16)-tr)**2 + (int(colors[name][2:4], 16)-tg)**2 + (int(colors[name][4:6], 16)-tb)**2))
  ")
  [[ -n "$closest" ]] && papirus-folders -C "$closest"
} >/dev/null 2>&1 </dev/null & disown
'
'''

# -----------------------------------------------------------------------------
# System Components (Wayland, Bars, Notifications)
# -----------------------------------------------------------------------------

[templates.hyprland]
input_path  = '~/.config/matugen/templates/hyprland-colors.conf'
output_path = '~/.config/matugen/generated/hyprland-colors.conf'
post_hook   = '''
bash -c '{ hyprctl reload; } >/dev/null 2>&1 </dev/null & disown'
'''

[templates.hyprlock]
input_path  = '~/.config/matugen/templates/hyprlock-colors.conf'
output_path = '~/.config/matugen/generated/hyprlock-colors.conf'

[templates.waybar]
input_path  = '~/.config/matugen/templates/colors.css'
output_path = '~/.config/matugen/generated/waybar-colors.css'
# systemd-run inherently detaches and logs to journalctl, which is the perfect approach here.
post_hook   = 'systemd-run --user --quiet bash -c "$HOME/user_scripts/waybar/waybar_autostart.sh"'

[templates.swaync]
input_path  = '~/.config/matugen/templates/colors.css'
output_path = '~/.config/matugen/generated/swaync-colors.css'
post_hook   = '''
bash -c '
{
  if command -v swaync-client >/dev/null 2>&1; then
    swaync-client -R
    swaync-client -rs
  fi
} >/dev/null 2>&1 </dev/null & disown
'
'''

[templates.swayosd]
input_path  = '~/.config/matugen/templates/swayosd-colors.css'
output_path = '~/.config/matugen/generated/swayosd-colors.css'
post_hook   = 'systemd-run --user --quiet bash -c "$HOME/user_scripts/swayosd/restart_swayosd.sh"'

[templates.wlogout]
input_path  = '~/.config/matugen/templates/colors.css'
output_path = '~/.config/matugen/generated/wlogout-colors.css'

[templates.rofi]
input_path  = '~/.config/matugen/templates/rofi-colors.rasi'
output_path = '~/.config/matugen/generated/rofi-colors.rasi'

# -----------------------------------------------------------------------------
# Applications (Terminals, Editors, Browsers)
# -----------------------------------------------------------------------------

[templates.kitty]
input_path  = '~/.config/matugen/templates/kitty-colors.conf'
output_path = '~/.config/matugen/generated/kitty-colors.conf'
post_hook   = '''
bash -c '
{
  ln -nfs "$HOME/.config/matugen/generated/kitty-colors.conf" "$HOME/.config/kitty/kitty-colors.conf"
  pkill -SIGUSR1 kitty
} >/dev/null 2>&1 </dev/null & disown
'
'''

[templates.opencode]
input_path = '~/.config/matugen/templates/opencode-colors.json'
output_path = '~/.config/opencode/generated/opencode.json'

[templates.vscode]
input_path  = '~/.config/matugen/templates/vscode.json'
output_path = '~/.config/matugen/generated/vscode.json'
post_hook   = '''
bash -c '
{
  if command -v vscodium >/dev/null 2>&1; then
    unlink "$HOME/.config/VSCodium/User/settings.json" && ln -nfs "$HOME/.config/matugen/generated/vscode.json" "$HOME/.config/VSCodium/User/settings.json"
  fi
} >/dev/null 2>&1 </dev/null & disown
'
'''

# [templates.alacritty]
# input_path  = '~/.config/matugen/templates/alacritty.toml'
# output_path = '~/.config/matugen/generated/alacritty-colors.toml'
# post_hook   = 'ln -nfs $HOME/.config/matugen/generated/alacritty-colors.toml $HOME/.config/alacritty/alacritty-colors.toml'

[templates.neovim]
input_path  = '~/.config/matugen/templates/neovim/template.lua'
output_path = '~/.config/matugen/generated/neovim-colors.lua'
post_hook   = '''
bash -c '{ pkill -SIGUSR1 nvim; } >/dev/null 2>&1 </dev/null & disown'
'''

[templates.yazi]
input_path  = '~/.config/matugen/templates/yazi-theme.toml'
output_path = '~/.config/matugen/generated/yazi-theme.toml'
post_hook   = '''
bash -c '{ ln -nfs "$HOME/.config/matugen/generated/yazi-theme.toml" "$HOME/.config/yazi/theme.toml"; } >/dev/null 2>&1 </dev/null & disown'
'''

[templates.zathura]
input_path  = '~/.config/matugen/templates/zathura-colors'
output_path = '~/.config/matugen/generated/zathura-colors'
post_hook   = '''
bash -c '{ ln -nfs "$HOME/.config/matugen/generated/zathura-colors" "$HOME/.config/zathura/zathurarc"; } >/dev/null 2>&1 </dev/null & disown'
'''

# [templates.starship]
# input_path = '~/.config/matugen/templates/starship-colors.toml'
# output_path = '~/.config/matugen/generated/starship-colors.toml'
# post_hook = 'ln -nfs $HOME/.config/matugen/generated/starship-colors $HOME/.config/starship.toml'

# [templates.tmux]
# input_path = '~/.config/matugen/templates/tmux-colors.conf'
# output_path = '~/.config/matugen/generated/tmux-colors.conf'
# post_hook = 'tmux source-file ~/.config/matugen/tmux-colors.conf'

[templates.pywalfox]
input_path  = '~/.config/matugen/templates/pywalfox-colors.json'
output_path = '~/.config/matugen/generated/pywalfox-colors.json'
post_hook   = '''
bash -c '
{
  if command -v pywalfox >/dev/null 2>&1; then
    mkdir -p "$HOME/.cache/wal"
    ln -nfs "$HOME/.config/matugen/generated/pywalfox-colors.json" "$HOME/.cache/wal/colors.json"
    pywalfox update
  fi
} >/dev/null 2>&1 </dev/null & disown
'
'''

[templates.Obsidian]
input_path  = '~/.config/matugen/templates/obsidian-theme.css'
output_path = '~/.config/matugen/generated/obsidian-theme.css'
post_hook   = '''
bash -c '
{
  mkdir -p "$HOME/Documents/pensive/.obsidian/snippets"
  ln -nfs "$HOME/.config/matugen/generated/obsidian-theme.css" "$HOME/Documents/pensive/.obsidian/snippets/matugen-theme.css"
} >/dev/null 2>&1 </dev/null & disown
'
'''

[templates.vesktop]
input_path  = '~/.config/matugen/templates/midnight-discord.css'
output_path = '~/.config/matugen/generated/midnight-discord.css'
post_hook   = '''
bash -c '
{
  mkdir -p "$HOME/.config/vesktop/themes/"
  ln -nfs "$HOME/.config/matugen/generated/midnight-discord.css" "$HOME/.config/vesktop/themes/midnight-discord.css"
} >/dev/null 2>&1 </dev/null & disown
'
'''

[templates.beeper]
input_path  = '~/.config/matugen/templates/beeper.css'
output_path = '~/.config/matugen/generated/beeper.css'
post_hook   = '''
bash -c '
{
  if command -v beeper >/dev/null 2>&1; then
    ln -nfs "$HOME/.config/matugen/generated/beeper.css" "$HOME/.config/BeeperTexts/custom.css"
    hyprctl dispatch sendshortcut "CTRL SHIFT ALT, R, class:^(BeeperTexts)$"
  fi
} >/dev/null 2>&1 </dev/null & disown
'
'''

[templates.spicetify]
input_path  = '~/.config/matugen/templates/spotify-colors.ini'
output_path = '~/.config/matugen/generated/spotify-colors.ini'
post_hook   = '''
if command -v spicetify &> /dev/null && [ -d "$HOME/.config/spicetify/Themes/Comfy" ]; then
    ln -nfs $HOME/.config/matugen/generated/spotify-colors.ini $HOME/.config/spicetify/Themes/Comfy/color.ini;
    spicetify apply -n;
    hyprctl dispatch sendshortcut "CTRL SHIFT, R, class:^(spotify)$" || true;
fi
'''

[templates.cava]
input_path  = '~/.config/matugen/templates/cava-colors.ini'
output_path = '~/.config/matugen/generated/cava-colors.ini'
post_hook   = '''
bash -c '
{
  mkdir -p "$HOME/.config/cava/themes"
  ln -nfs "$HOME/.config/matugen/generated/cava-colors.ini" "$HOME/.config/cava/themes/cava-colors.ini"
  pkill -USR1 cava
} >/dev/null 2>&1 </dev/null & disown
'
'''

[templates.btop]
input_path  = '~/.config/matugen/templates/btop.theme'
output_path = '~/.config/matugen/generated/btop-colors.theme'
post_hook   = '''
bash -c '
{
  mkdir -p "$HOME/.config/btop/themes"
  ln -nfs "$HOME/.config/matugen/generated/btop-colors.theme" "$HOME/.config/btop/themes/matugen.theme"
  notify-send -i applications-graphics-symbolic "Theme Updated"
} >/dev/null 2>&1 </dev/null & disown
'
'''

[templates.script_runner]
input_path  = '/dev/null'
output_path = '/dev/null'
post_hook   = '''
bash -c '
{
  # Add future scripts below this line with an `&` at the end

  "$HOME/user_scripts/dusky_system/reload_cc/cc_restart.sh" --quiet &
  "$HOME/user_scripts/sliders/reload_sliders/reload_sliders.sh" --quiet &

} >/dev/null 2>&1 </dev/null & disown
'
'''

[templates.command_runner]
input_path  = '/dev/null'
output_path = '/dev/null'
post_hook   = '''
bash -c '
{
  # Add future commands below this line (executed sequentially)
  systemctl --user reset-failed hyprpolkitagent
  systemctl --user restart hyprpolkitagent

} >/dev/null 2>&1 </dev/null & disown
'
'''
